version: '3.6'
services:
  init:
    profiles: ["cli"]
    image: alpine
    command:
      - /bin/sh
      - -c
      - |
        chown -R 1000:1000 /data

        echo "done grany data directory permission"
    volumes:
      - data:/data

        # geth-builder:
        # profiles: [ "cli", "full-blockchain", "signer-node", "bootnode", "member-node", "archive-node", "service-node" ]
        # image: alpine
        #build:
        #context: ..
        #dockerfile: docker/builder/Dockerfile
        #container_name: geth-builder
        #restart: "no"

  geth-cli:
    profiles: ["cli"]
    build:
      context: ..
      dockerfile: docker/cli/Dockerfile
    container_name: geth-cli
    network_mode: host
    restart: "no"
    volumes:
      - data:/data
      - config:/config
#    networks:
#      - node-network

volumes:
  config:
    driver: local
    driver_opts:
      type: 'none'
      o: 'bind'
      device: ${MOUNT_DIR}/config/mainnet
  data:
    driver: local
    driver_opts:
      type: 'none'
      o: 'bind'
      device: ${MOUNT_DIR}/data/mainnet

#networks:
#  node-network:
#    driver: bridge